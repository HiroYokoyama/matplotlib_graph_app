# Matplotlib Graphing App (ver. 0.1.0)

## 概要 (Overview)

これは、CSVやExcelファイルをロードし、Matplotlibを使用してカスタマイズ可能なグラフを作成するためのGUIアプリケーションです。tkinter、pandas、tksheetライブラリを使用しています。

作成したグラフは画像（PNG, SVG, PDF）としてエクスポートでき、適用した設定はJSONファイルとして保存・再ロードすることができます。

## 主な特徴 (Features)

  * **データ入力**:
      * CSVおよびExcelファイル（`.xlsx`, `.xls`）の読み込みに対応。
      * `tksheet`を使用したスプレッドシート形式でのデータ表示と編集。
  * **グラフタイプ**:
      * 線グラフ（line）、散布図（scatter）、棒グラフ（bar）を選択可能。
  * **柔軟な軸設定**:
      * X軸のデータを選択。
      * Y軸（左）とY軸（右）にそれぞれ複数のデータを選択可能（2軸グラフ対応）。
  * **詳細なカスタマイズ (シリーズごと)**:
      * 「Style」タブから、プロットする各データシリーズ（例: Y1の "Data A", Y2の "Data B"）を個別に選択。
      * 色（自動または手動）、線のスタイル、マーカーのスタイル、線の幅、透明度（アルファ）を個別に設定可能。
  * **全体的なスタイル設定**:
      * グラフタイトル、各軸のラベル。
      * グラフの図（Figure）のサイズ（インチ単位）。
      * フォントファミリー（システムにインストールされているフォントを自動取得）。
      * 各要素（タイトル、ラベル、目盛り）のフォントサイズ。
      * グリッド、マーカーの全体的な表示/非表示。
  * **軸の詳細設定**:
      * X軸、Y1軸、Y2軸の表示範囲（最小値・最大値）を指定可能。
      * 各軸の目盛り（Ticks）の表示/非表示、および向き（`in`, `out`）の指定。
      * 科学的表記（例: 1.0e+5）を無効にし、通常の数値表示（例: 100000）に強制するオプション。
      * ログスケール（対数軸）の有効化（X, Y1, Y2それぞれ）。
  * **外観**:
      * グラフの枠線（Spines: 上下左右）の表示/非表示を個別に設定。
      * グラフの背景色（Axes: 軸の内側）と図の背景色（Figure: 軸の外側）を個別に設定。
  * **凡例**:
      * 凡例の表示/非表示、および表示位置（`best`, `upper right`など）を選択可能。
  * **保存とエクスポート**:
      * 現在のすべての設定（データファイルパス、軸の選択、全スタイル設定）をJSONファイルに保存。
      * JSONファイルから設定をロードし、グラフを即座に再現。
      * 作成したグラフをPNG, SVG, PDF形式でエクスポート。

## 前提条件 (Requirements)

このスクリプトを実行するには、以下のPythonライブラリが必要です。

  * `pandas`
  * `matplotlib`
  * `tksheet`
  * `openpyxl` (Excelファイルの読み込みに必要)

## インストール (Installation)

必要なライブラリは、pipを使用してインストールできます。

```bash
pip install pandas matplotlib tksheet openpyxl
```

## 使い方 (Usage)

1.  リポジトリをクローンまたはスクリプト (`matplotlib_graph_app.py`) をダウンロードします。

2.  ターミナルでスクリプトを実行します。

    ```bash
    python matplotlib_graph_app.py
    ```

3.  **基本的な操作フロー**:

    1.  **[Load Data (CSV/Excel)]**: クリックしてデータファイルを選択します。データが下部のエディタに表示されます。
    2.  **[Basic Settings]**:
          * `X-Axis` \> `Data` でX軸に使用する列を選択します。
          * `Y-Axis (Left)` \> `Data` でY軸（左）に使用する列を（複数選択可）選択します。
          * （オプション）`Y-Axis (Right)` \> `Data` でY軸（右）に使用する列を選択します。
    3.  **[Plot/Update Graph]**: クリックすると、右側にグラフが描画されます。
    4.  **カスタマイズ**:
          * **[Style]**: `Select Series (Y1/Y2)`ドロップダウンから編集したいデータ系列を選択し、色や線のスタイルを変更します。
          * **[Font]**: フォントファミリーやサイズを変更します。
          * **[Axis/Ticks]**: 軸の範囲や目盛りのスタイルを変更します。
          * **[Spines/BG]**: 枠線や背景色を変更します。
          * **[Legend]**: 凡例の設定を変更します。
    5.  設定を変更したら、都度 **[Plot/Update Graph]** をクリックしてグラフを更新します。
    6.  **[Export Graph (Image)]**: グラフを画像ファイルとして保存します。
    7.  **[Save Settings (.json)]**: 現在のグラフ設定をJSONファイルとして保存します。（次回 `Load Settings` から再開できます）

